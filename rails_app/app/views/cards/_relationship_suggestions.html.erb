<%# AI relationship suggestions
    Accepts: card (required), suggestions (required) %>
<div class="space-y-2 mt-4 fade-in">
  <div class="flex items-center gap-2 mb-2">
    <svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
    </svg>
    <h4 class="text-sm font-medium text-purple-900">Suggested Relationships</h4>
    <span class="text-xs text-purple-600 bg-purple-100 px-2 py-0.5 rounded-full"><%= suggestions.count %></span>
  </div>

  <div class="space-y-2 stagger-fade-in">
    <% suggestions.each do |suggestion| %>
      <% target = suggestion.target_card %>
      <% next unless target %>
      <div id="<%= dom_id(suggestion) %>" class="p-3 bg-purple-50 rounded-lg border border-purple-200 transition-all duration-200 hover:shadow-sm">
        <div class="flex items-start justify-between gap-2">
          <div class="flex-1 min-w-0">
            <div class="flex items-center gap-2 mb-1">
              <span class="inline-flex items-center rounded px-1.5 py-0.5 text-xs font-medium
                <%= case suggestion.relationship_type_name
                    when 'blocks' then 'bg-orange-100 text-orange-800'
                    when 'depends_on' then 'bg-yellow-100 text-yellow-800'
                    else 'bg-blue-100 text-blue-800'
                    end %>">
                <%= suggestion.relationship_type_name&.humanize || 'Related' %>
              </span>
              <% if suggestion.confidence %>
                <span class="text-xs text-purple-500">
                  <%= suggestion.confidence %> confidence
                </span>
              <% end %>
            </div>
            <p class="text-sm text-purple-900 font-medium truncate">
              <%= target.title %>
            </p>
            <% if suggestion.reasoning.present? %>
              <p class="text-xs text-purple-600 mt-1"><%= suggestion.reasoning %></p>
            <% end %>
          </div>

          <div class="flex gap-1 flex-shrink-0">
            <%= button_to accept_board_card_ai_suggestion_path(card.board, card, suggestion),
                method: :post,
                class: "p-1.5 text-green-600 hover:bg-green-100 rounded transition-colors",
                data: { turbo_method: :post },
                title: "Accept relationship" do %>
              <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
            <% end %>

            <%= button_to dismiss_board_card_ai_suggestion_path(card.board, card, suggestion),
                method: :delete,
                class: "p-1.5 text-red-600 hover:bg-red-100 rounded transition-colors",
                data: { turbo_method: :delete },
                title: "Dismiss suggestion" do %>
              <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
