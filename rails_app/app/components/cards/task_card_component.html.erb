<div id="<%= dom_id %>"
     class="kanban-card bg-white rounded-lg shadow-sm p-3 cursor-pointer hover:shadow-md transition-shadow border-l-4 <%= border_color_class %>"
     data-card-id="<%= card.id %>"
     data-controller="draggable"
     data-action="click->kanban#showCardDetail"
     draggable="true"
     data-draggable-target="item">

  <%# Card Type Indicator %>
  <div class="flex items-center gap-1 mb-1">
    <span class="inline-flex items-center gap-1 text-xs text-<%= card_type_color %>-600">
      <%= render_icon(card_type_icon, classes: "h-3 w-3") %>
      <span><%= card_type_display_name %></span>
    </span>
  </div>

  <%# Title %>
  <h4 class="text-sm font-medium text-gray-900"><%= card.title %></h4>

  <%# Description %>
  <% if card.description.present? %>
    <p class="mt-1 text-xs text-gray-500 line-clamp-2"><%= card.description %></p>
  <% end %>

  <%# Task-specific: Status and Time Tracking %>
  <div class="mt-2 flex items-center gap-2 flex-wrap">
    <span class="inline-flex items-center rounded px-1.5 py-0.5 text-xs font-medium <%= status_badge_classes %>">
      <%= status.humanize %>
    </span>

    <% if show_time_tracking? %>
      <span class="text-xs text-gray-500">
        <%= actual_hours || 0 %>/<%= estimated_hours || "?" %>h
      </span>
    <% end %>
  </div>

  <%# Progress Bar %>
  <% if progress_percentage %>
    <div class="mt-2 h-1 bg-gray-200 rounded-full overflow-hidden">
      <div class="h-full bg-blue-500 transition-all" style="width: <%= progress_percentage %>%"></div>
    </div>
  <% end %>

  <%# Tags %>
  <% if show_tags? %>
    <div class="mt-2 flex flex-wrap gap-1">
      <% tags.first(3).each do |tag| %>
        <span class="inline-flex items-center rounded bg-gray-100 px-1.5 py-0.5 text-xs text-gray-600">
          <%= tag %>
        </span>
      <% end %>
      <% if tags.count > 3 %>
        <span class="text-xs text-gray-400">+<%= tags.count - 3 %></span>
      <% end %>
    </div>
  <% end %>

  <%# Footer: Priority, Due Date, Assignees %>
  <div class="mt-3 flex items-center justify-between">
    <div class="flex items-center gap-2">
      <span class="inline-flex items-center rounded px-1.5 py-0.5 text-xs font-medium <%= priority_classes %>">
        <%= card.priority.capitalize %>
      </span>

      <% if card.due_date.present? %>
        <span class="inline-flex items-center gap-1 text-xs <%= due_date_classes %>">
          <%= render_icon("calendar", classes: "h-3 w-3") %>
          <%= card.due_date.strftime("%b %d") %>
        </span>
      <% end %>
    </div>

    <%# Assignees %>
    <% if card.assignees.any? %>
      <div class="flex -space-x-1">
        <% card.assignees.first(3).each do |assignee| %>
          <div class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-blue-600 text-white text-xs font-medium ring-1 ring-white" title="<%= assignee.name %>">
            <%= assignee.initials %>
          </div>
        <% end %>
        <% if card.assignees.count > 3 %>
          <div class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-200 text-gray-600 text-xs font-medium ring-1 ring-white">
            +<%= card.assignees.count - 3 %>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
